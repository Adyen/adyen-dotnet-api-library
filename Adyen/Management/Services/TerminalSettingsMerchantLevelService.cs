// <auto-generated>
/*
 * Management API
 *
 * Configure and manage your Adyen company and merchant accounts, stores, and payment terminals. ## Authentication Each request to the Management API must be signed with an API key. [Generate your API key](https://docs.adyen.com/development-resources/api-credentials#generate-api-key) in the Customer Area and then set this key to the `X-API-Key` header value.  To access the live endpoints, you need to generate a new API key in your live Customer Area. ## Versioning  Management API handles versioning as part of the endpoint URL. For example, to send a request to this version of the `/companies/{companyId}/webhooks` endpoint, use:  ```text https://management-test.adyen.com/v3/companies/{companyId}/webhooks ```  ## Going live  To access the live endpoints, you need an API key from your live Customer Area. Use this API key to make requests to:  ```text https://management-live.adyen.com/v3 ```  ## Release notes Have a look at the [release notes](https://docs.adyen.com/release-notes/management-api) to find out what changed in this version!
 *
 * The version of the OpenAPI document: 3
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

#nullable enable

using System;
using System.Collections.Generic;
using System.Net;
using System.Threading.Tasks;
using Microsoft.Extensions.Logging;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Text.Json;
using Adyen.Core;
using Adyen.Core.Auth;
using Adyen.Core.Client;
using Adyen.Management.Client;
using Adyen.Management.Models;
using System.Diagnostics.CodeAnalysis;

namespace Adyen.Management.Services
{
    /// <summary>
    /// Represents a collection of functions to interact with the API endpoints.
    /// This class is registered as transient.
    /// </summary>
    public interface ITerminalSettingsMerchantLevelService : IAdyenApiService
    {
        /// <summary>
        /// The class containing the events.
        /// </summary>
        TerminalSettingsMerchantLevelServiceEvents Events { get; }

        /// <summary>
        /// Get the terminal logo
        /// </summary>
        /// <remarks>
        /// Returns the logo that is configured for a specific payment terminal model at the merchant account identified in the path.  The logo is returned as a Base64-encoded string. You need to Base64-decode the string to get the actual image file.  This logo applies to all terminals of the specified model under the merchant account, unless a different logo is configured at a lower level (store or individual terminal).  To make this request, your API credential must have one of the following [roles](https://docs.adyen.com/development-resources/api-credentials#api-permissions): * Management API—Terminal settings read * Management API—Terminal settings read and write  In the live environment, requests to this endpoint are subject to [rate limits](https://docs.adyen.com/point-of-sale/automating-terminal-management#rate-limits-in-the-live-environment).
        /// </remarks>
        /// <exception cref="ApiException">Thrown when fails to make API call.</exception>
        /// <param name="merchantId">The unique identifier of the merchant account.</param>
        /// <param name="model">The terminal model. Possible values: E355, VX675WIFIBT, VX680, VX690, VX700, VX820, M400, MX925, P400Plus, UX300, UX410, V200cPlus, V240mPlus, V400cPlus, V400m, e280, e285, e285p, S1E, S1EL, S1F2, S1L, S1U, S7T.</param>
        /// <param name="cancellationToken">Cancellation Token to cancel the request.</param>
        /// <returns><see cref="Task"/>&lt;<see cref="IGetTerminalLogoApiResponse"/>&gt;</returns>
        Task<IGetTerminalLogoApiResponse> GetTerminalLogoAsync(string merchantId, string model, System.Threading.CancellationToken cancellationToken = default);

        /// <summary>
        /// Get terminal settings
        /// </summary>
        /// <remarks>
        /// Returns the payment terminal settings that are configured for the merchant account identified in the path. These settings apply to all terminals under the merchant account unless different values are configured at a lower level (store or individual terminal).  To make this request, your API credential must have one of the following [roles](https://docs.adyen.com/development-resources/api-credentials#api-permissions): * Management API—Terminal settings read * Management API—Terminal settings read and write  For [sensitive terminal settings](https://docs.adyen.com/point-of-sale/automating-terminal-management/configure-terminals-api#sensitive-terminal-settings), your API credential must have the following role: * Management API—Terminal settings Advanced read and write  In the live environment, requests to this endpoint are subject to [rate limits](https://docs.adyen.com/point-of-sale/automating-terminal-management#rate-limits-in-the-live-environment).
        /// </remarks>
        /// <exception cref="ApiException">Thrown when fails to make API call.</exception>
        /// <param name="merchantId">The unique identifier of the merchant account.</param>
        /// <param name="cancellationToken">Cancellation Token to cancel the request.</param>
        /// <returns><see cref="Task"/>&lt;<see cref="IGetTerminalSettingsApiResponse"/>&gt;</returns>
        Task<IGetTerminalSettingsApiResponse> GetTerminalSettingsAsync(string merchantId, System.Threading.CancellationToken cancellationToken = default);

        /// <summary>
        /// Update the terminal logo
        /// </summary>
        /// <remarks>
        /// Updates the logo for a specific payment terminal model at the merchant account identified in the path. You can update the logo for only one terminal model at a time.  This logo applies to all terminals of the specified model under the merchant account, unless a different logo is configured at a lower level (store or individual terminal).  * To change the logo, specify the image file as a Base64-encoded string. * To restore the logo inherited from the company account, specify an empty logo value.  To make this request, your API credential must have the following [role](https://docs.adyen.com/development-resources/api-credentials#api-permissions): * Management API—Terminal settings read and write  In the live environment, requests to this endpoint are subject to [rate limits](https://docs.adyen.com/point-of-sale/automating-terminal-management#rate-limits-in-the-live-environment).
        /// </remarks>
        /// <exception cref="ApiException">Thrown when fails to make API call.</exception>
        /// <param name="merchantId">The unique identifier of the merchant account.</param>
        /// <param name="model">The terminal model. Allowed values: E355, VX675WIFIBT, VX680, VX690, VX700, VX820, M400, MX925, P400Plus, UX300, UX410, V200cPlus, V240mPlus, V400cPlus, V400m, e280, e285, e285p, S1E, S1EL, S1F2, S1L, S1U, S7T.</param>
        /// <param name="logo"> (optional)</param>
        /// <param name="cancellationToken">Cancellation Token to cancel the request.</param>
        /// <returns><see cref="Task"/>&lt;<see cref="IUpdateTerminalLogoApiResponse"/>&gt;</returns>
        Task<IUpdateTerminalLogoApiResponse> UpdateTerminalLogoAsync(string merchantId, string model, Option<Logo> logo = default, System.Threading.CancellationToken cancellationToken = default);

        /// <summary>
        /// Update terminal settings
        /// </summary>
        /// <remarks>
        /// Updates payment terminal settings for the merchant account identified in the path. These settings apply to all terminals under the merchant account, unless different values are configured at a lower level (store or individual terminal).  * To change a parameter value, include the full object that contains the parameter, even if you don&#39;t want to change all parameters in the object. * To restore a parameter value inherited from a higher level, include the full object that contains the parameter, and specify an empty value for the parameter or omit the parameter. * Objects that are not included in the request are not updated.  To make this request, your API credential must have the following [role](https://docs.adyen.com/development-resources/api-credentials#api-permissions): * Management API—Terminal settings read and write    For [sensitive terminal settings](https://docs.adyen.com/point-of-sale/automating-terminal-management/configure-terminals-api#sensitive-terminal-settings), your API credential must have the following role: * Management API—Terminal settings Advanced read and write  In the live environment, requests to this endpoint are subject to [rate limits](https://docs.adyen.com/point-of-sale/automating-terminal-management#rate-limits-in-the-live-environment).
        /// </remarks>
        /// <exception cref="ApiException">Thrown when fails to make API call.</exception>
        /// <param name="merchantId">The unique identifier of the merchant account.</param>
        /// <param name="terminalSettings"> (optional)</param>
        /// <param name="cancellationToken">Cancellation Token to cancel the request.</param>
        /// <returns><see cref="Task"/>&lt;<see cref="IUpdateTerminalSettingsApiResponse"/>&gt;</returns>
        Task<IUpdateTerminalSettingsApiResponse> UpdateTerminalSettingsAsync(string merchantId, Option<TerminalSettings> terminalSettings = default, System.Threading.CancellationToken cancellationToken = default);

    }

    /// <summary>
    /// Represents a collection of functions to interact with the API endpoints.
    /// </summary>
    public class TerminalSettingsMerchantLevelServiceEvents
    {
        /// <summary>
        /// The event raised after the server response.
        /// </summary>
        public event EventHandler<ApiResponseEventArgs>? OnGetTerminalLogo;

        /// <summary>
        /// The event raised after an error querying the server.
        /// </summary>
        public event EventHandler<ExceptionEventArgs>? OnErrorGetTerminalLogo;

        internal void ExecuteOnGetTerminalLogo(TerminalSettingsCompanyLevelService.GetTerminalLogoApiResponse apiResponse)
        {
            OnGetTerminalLogo?.Invoke(this, new ApiResponseEventArgs(apiResponse));
        }

        internal void ExecuteOnErrorGetTerminalLogo(Exception exception)
        {
            OnErrorGetTerminalLogo?.Invoke(this, new ExceptionEventArgs(exception));
        }

        /// <summary>
        /// The event raised after the server response.
        /// </summary>
        public event EventHandler<ApiResponseEventArgs>? OnGetTerminalSettings;

        /// <summary>
        /// The event raised after an error querying the server.
        /// </summary>
        public event EventHandler<ExceptionEventArgs>? OnErrorGetTerminalSettings;

        internal void ExecuteOnGetTerminalSettings(TerminalSettingsCompanyLevelService.GetTerminalSettingsApiResponse apiResponse)
        {
            OnGetTerminalSettings?.Invoke(this, new ApiResponseEventArgs(apiResponse));
        }

        internal void ExecuteOnErrorGetTerminalSettings(Exception exception)
        {
            OnErrorGetTerminalSettings?.Invoke(this, new ExceptionEventArgs(exception));
        }

        /// <summary>
        /// The event raised after the server response.
        /// </summary>
        public event EventHandler<ApiResponseEventArgs>? OnUpdateTerminalLogo;

        /// <summary>
        /// The event raised after an error querying the server.
        /// </summary>
        public event EventHandler<ExceptionEventArgs>? OnErrorUpdateTerminalLogo;

        internal void ExecuteOnUpdateTerminalLogo(TerminalSettingsCompanyLevelService.UpdateTerminalLogoApiResponse apiResponse)
        {
            OnUpdateTerminalLogo?.Invoke(this, new ApiResponseEventArgs(apiResponse));
        }

        internal void ExecuteOnErrorUpdateTerminalLogo(Exception exception)
        {
            OnErrorUpdateTerminalLogo?.Invoke(this, new ExceptionEventArgs(exception));
        }

        /// <summary>
        /// The event raised after the server response.
        /// </summary>
        public event EventHandler<ApiResponseEventArgs>? OnUpdateTerminalSettings;

        /// <summary>
        /// The event raised after an error querying the server.
        /// </summary>
        public event EventHandler<ExceptionEventArgs>? OnErrorUpdateTerminalSettings;

        internal void ExecuteOnUpdateTerminalSettings(TerminalSettingsCompanyLevelService.UpdateTerminalSettingsApiResponse apiResponse)
        {
            OnUpdateTerminalSettings?.Invoke(this, new ApiResponseEventArgs(apiResponse));
        }

        internal void ExecuteOnErrorUpdateTerminalSettings(Exception exception)
        {
            OnErrorUpdateTerminalSettings?.Invoke(this, new ExceptionEventArgs(exception));
        }
    }

    /// <summary>
    /// Represents a collection of functions to interact with the API endpoints.
    /// </summary>
    public sealed partial class TerminalSettingsMerchantLevelService : ITerminalSettingsMerchantLevelService
    {
        private JsonSerializerOptions _jsonSerializerOptions;

        /// <summary>
        /// The logger factory.
        /// </summary>
        public ILoggerFactory LoggerFactory { get; }

        /// <summary>
        /// The logger.
        /// </summary>
        public ILogger<TerminalSettingsMerchantLevelService> Logger { get; }

        /// <summary>
        /// The HttpClient.
        /// </summary>
        public System.Net.Http.HttpClient HttpClient { get; }

        /// <summary>
        /// The class containing the events.
        /// </summary>
        public TerminalSettingsMerchantLevelServiceEvents Events { get; }

        /// <summary>
        /// A token provider of type <see cref="ApiKeyProvider"/>.
        /// </summary>
        public ITokenProvider<ApiKeyToken> ApiKeyProvider { get; }

        /// <summary>
        /// Initializes a new instance of the <see cref="TerminalSettingsMerchantLevelService"/> class.
        /// </summary>
        /// <returns></returns>
        public TerminalSettingsMerchantLevelService(ILogger<TerminalSettingsMerchantLevelService> logger, ILoggerFactory loggerFactory, System.Net.Http.HttpClient httpClient, JsonSerializerOptionsProvider jsonSerializerOptionsProvider, TerminalSettingsMerchantLevelServiceEvents terminalSettingsMerchantLevelServiceEvents,
            ITokenProvider<ApiKeyToken> apiKeyProvider)
        {
            _jsonSerializerOptions = jsonSerializerOptionsProvider.Options;
            LoggerFactory = loggerFactory;
            Logger = LoggerFactory.CreateLogger<TerminalSettingsMerchantLevelService>();
            HttpClient = httpClient;
            Events = terminalSettingsMerchantLevelServiceEvents;
            ApiKeyProvider = apiKeyProvider;
        }

        partial void FormatGetTerminalLogo(ref string merchantId, ref string model);

        /// <summary>
        /// Validates the request parameters.
        /// </summary>
        /// <param name="merchantId"></param>
        /// <param name="model"></param>
        /// <returns></returns>
        private void ValidateGetTerminalLogo(string merchantId, string model)
        {
            if (merchantId == null)
                throw new ArgumentNullException(nameof(merchantId));

            if (model == null)
                throw new ArgumentNullException(nameof(model));
        }

        /// <summary>
        /// Processes the server response.
        /// </summary>
        /// <param name="apiResponse"></param>
        /// <param name="merchantId"></param>
        /// <param name="model"></param>
        private void AfterGetTerminalLogoDefaultImplementation(IGetTerminalLogoApiResponse apiResponse, string merchantId, string model)
        {
            bool suppressDefaultLog = false;
            AfterGetTerminalLogo(ref suppressDefaultLog, apiResponse, merchantId, model);
            if (!suppressDefaultLog)
                Logger.LogInformation("{0,-9} | {1} | {3}", (apiResponse.DownloadedAt - apiResponse.RequestedAt).TotalSeconds, apiResponse.StatusCode, apiResponse.Path);
        }

        /// <summary>
        /// Processes the server response.
        /// </summary>
        /// <param name="suppressDefaultLog"></param>
        /// <param name="apiResponse"></param>
        /// <param name="merchantId"></param>
        /// <param name="model"></param>
        partial void AfterGetTerminalLogo(ref bool suppressDefaultLog, IGetTerminalLogoApiResponse apiResponse, string merchantId, string model);

        /// <summary>
        /// Logs exceptions that occur while retrieving the server response.
        /// </summary>
        /// <param name="exception"></param>
        /// <param name="pathFormat"></param>
        /// <param name="path"></param>
        /// <param name="merchantId"></param>
        /// <param name="model"></param>
        private void OnErrorGetTerminalLogoDefaultImplementation(Exception exception, string pathFormat, string path, string merchantId, string model)
        {
            bool suppressDefaultLog = false;
            OnErrorGetTerminalLogo(ref suppressDefaultLog, exception, pathFormat, path, merchantId, model);
            if (!suppressDefaultLog)
                Logger.LogError(exception, "An error occurred while sending the request to the server.");
        }

        /// <summary>
        /// A partial method that gives developers a way to provide customized exception handling.
        /// </summary>
        /// <param name="suppressDefaultLog"></param>
        /// <param name="exception"></param>
        /// <param name="pathFormat"></param>
        /// <param name="path"></param>
        /// <param name="merchantId"></param>
        /// <param name="model"></param>
        partial void OnErrorGetTerminalLogo(ref bool suppressDefaultLog, Exception exception, string pathFormat, string path, string merchantId, string model);

        /// <summary>
        /// Get the terminal logo Returns the logo that is configured for a specific payment terminal model at the merchant account identified in the path.  The logo is returned as a Base64-encoded string. You need to Base64-decode the string to get the actual image file.  This logo applies to all terminals of the specified model under the merchant account, unless a different logo is configured at a lower level (store or individual terminal).  To make this request, your API credential must have one of the following [roles](https://docs.adyen.com/development-resources/api-credentials#api-permissions): * Management API—Terminal settings read * Management API—Terminal settings read and write  In the live environment, requests to this endpoint are subject to [rate limits](https://docs.adyen.com/point-of-sale/automating-terminal-management#rate-limits-in-the-live-environment).
        /// </summary>
        /// <exception cref="ApiException">Thrown when fails to make API call.</exception>
        /// <param name="merchantId">The unique identifier of the merchant account.</param>
        /// <param name="model">The terminal model. Possible values: E355, VX675WIFIBT, VX680, VX690, VX700, VX820, M400, MX925, P400Plus, UX300, UX410, V200cPlus, V240mPlus, V400cPlus, V400m, e280, e285, e285p, S1E, S1EL, S1F2, S1L, S1U, S7T.</param>
        /// <param name="cancellationToken">Cancellation Token to cancel the request.</param>
        /// <returns><see cref="Task"/>&lt;<see cref="IGetTerminalLogoApiResponse"/>&gt;</returns>
        public async Task<IGetTerminalLogoApiResponse> GetTerminalLogoAsync(string merchantId, string model, System.Threading.CancellationToken cancellationToken = default)
        {
            UriBuilder uriBuilder = new UriBuilder();

            try
            {
                ValidateGetTerminalLogo(merchantId, model);

                FormatGetTerminalLogo(ref merchantId, ref model);

                using (HttpRequestMessage httpRequestMessage = new HttpRequestMessage())
                {
                    uriBuilder.Host = HttpClient.BaseAddress!.Host;
                    uriBuilder.Port = HttpClient.BaseAddress.Port;
                    uriBuilder.Scheme = HttpClient.BaseAddress.Scheme;
                    uriBuilder.Path = HttpClient.BaseAddress.AbsolutePath == "/"
                        ? "/merchants/{merchantId}/terminalLogos"
                        : string.Concat(HttpClient.BaseAddress.AbsolutePath, "/merchants/{merchantId}/terminalLogos");
                    uriBuilder.Path = uriBuilder.Path.Replace("%7BmerchantId%7D", Uri.EscapeDataString(merchantId.ToString()));

                    System.Collections.Specialized.NameValueCollection parseQueryString = System.Web.HttpUtility.ParseQueryString(string.Empty);

                    parseQueryString["model"] = ClientUtils.ParameterToString(model);

                    uriBuilder.Query = parseQueryString.ToString();

                    ApiKeyToken apiKeyToken2 = (ApiKeyToken) ApiKeyProvider.Get();
                    apiKeyToken2.AddTokenToHttpRequestMessageHeader(httpRequestMessage);
                    httpRequestMessage.RequestUri = uriBuilder.Uri;

                    string[] accepts = new string[] {
                        "application/json"
                    };

                    string? accept = ClientUtils.SelectHeaderAccept(accepts);

                    if (accept != null)
                        httpRequestMessage.Headers.Accept.Add(new MediaTypeWithQualityHeaderValue(accept));

                    httpRequestMessage.Method = HttpMethod.Get;

                    DateTime requestedAt = DateTime.UtcNow;

                    using (HttpResponseMessage httpResponseMessage = await HttpClient.SendAsync(httpRequestMessage, cancellationToken).ConfigureAwait(false))
                    {
                        ILogger<TerminalSettingsCompanyLevelService.GetTerminalLogoApiResponse> apiResponseLogger = LoggerFactory.CreateLogger<TerminalSettingsCompanyLevelService.GetTerminalLogoApiResponse>();
                        TerminalSettingsCompanyLevelService.GetTerminalLogoApiResponse apiResponse;

                        switch ((int)httpResponseMessage.StatusCode) {
                            default: {
                                string responseContent = await httpResponseMessage.Content.ReadAsStringAsync(cancellationToken).ConfigureAwait(false);
                                apiResponse = new(apiResponseLogger, httpRequestMessage, httpResponseMessage, responseContent, "/merchants/{merchantId}/terminalLogos", requestedAt, _jsonSerializerOptions);

                                break;
                            }
                        }

                        AfterGetTerminalLogoDefaultImplementation(apiResponse, merchantId, model);

                        Events.ExecuteOnGetTerminalLogo(apiResponse);
                    
                        return apiResponse;
                    }
                }
            }
            catch(Exception e)
            {
                OnErrorGetTerminalLogoDefaultImplementation(e, "/merchants/{merchantId}/terminalLogos", uriBuilder.Path, merchantId, model);
                Events.ExecuteOnErrorGetTerminalLogo(e);
                throw;
            }
        }

        partial void FormatGetTerminalSettings(ref string merchantId);

        /// <summary>
        /// Validates the request parameters.
        /// </summary>
        /// <param name="merchantId"></param>
        /// <returns></returns>
        private void ValidateGetTerminalSettings(string merchantId)
        {
            if (merchantId == null)
                throw new ArgumentNullException(nameof(merchantId));
        }

        /// <summary>
        /// Processes the server response.
        /// </summary>
        /// <param name="apiResponse"></param>
        /// <param name="merchantId"></param>
        private void AfterGetTerminalSettingsDefaultImplementation(IGetTerminalSettingsApiResponse apiResponse, string merchantId)
        {
            bool suppressDefaultLog = false;
            AfterGetTerminalSettings(ref suppressDefaultLog, apiResponse, merchantId);
            if (!suppressDefaultLog)
                Logger.LogInformation("{0,-9} | {1} | {3}", (apiResponse.DownloadedAt - apiResponse.RequestedAt).TotalSeconds, apiResponse.StatusCode, apiResponse.Path);
        }

        /// <summary>
        /// Processes the server response.
        /// </summary>
        /// <param name="suppressDefaultLog"></param>
        /// <param name="apiResponse"></param>
        /// <param name="merchantId"></param>
        partial void AfterGetTerminalSettings(ref bool suppressDefaultLog, IGetTerminalSettingsApiResponse apiResponse, string merchantId);

        /// <summary>
        /// Logs exceptions that occur while retrieving the server response.
        /// </summary>
        /// <param name="exception"></param>
        /// <param name="pathFormat"></param>
        /// <param name="path"></param>
        /// <param name="merchantId"></param>
        private void OnErrorGetTerminalSettingsDefaultImplementation(Exception exception, string pathFormat, string path, string merchantId)
        {
            bool suppressDefaultLog = false;
            OnErrorGetTerminalSettings(ref suppressDefaultLog, exception, pathFormat, path, merchantId);
            if (!suppressDefaultLog)
                Logger.LogError(exception, "An error occurred while sending the request to the server.");
        }

        /// <summary>
        /// A partial method that gives developers a way to provide customized exception handling.
        /// </summary>
        /// <param name="suppressDefaultLog"></param>
        /// <param name="exception"></param>
        /// <param name="pathFormat"></param>
        /// <param name="path"></param>
        /// <param name="merchantId"></param>
        partial void OnErrorGetTerminalSettings(ref bool suppressDefaultLog, Exception exception, string pathFormat, string path, string merchantId);

        /// <summary>
        /// Get terminal settings Returns the payment terminal settings that are configured for the merchant account identified in the path. These settings apply to all terminals under the merchant account unless different values are configured at a lower level (store or individual terminal).  To make this request, your API credential must have one of the following [roles](https://docs.adyen.com/development-resources/api-credentials#api-permissions): * Management API—Terminal settings read * Management API—Terminal settings read and write  For [sensitive terminal settings](https://docs.adyen.com/point-of-sale/automating-terminal-management/configure-terminals-api#sensitive-terminal-settings), your API credential must have the following role: * Management API—Terminal settings Advanced read and write  In the live environment, requests to this endpoint are subject to [rate limits](https://docs.adyen.com/point-of-sale/automating-terminal-management#rate-limits-in-the-live-environment).
        /// </summary>
        /// <exception cref="ApiException">Thrown when fails to make API call.</exception>
        /// <param name="merchantId">The unique identifier of the merchant account.</param>
        /// <param name="cancellationToken">Cancellation Token to cancel the request.</param>
        /// <returns><see cref="Task"/>&lt;<see cref="IGetTerminalSettingsApiResponse"/>&gt;</returns>
        public async Task<IGetTerminalSettingsApiResponse> GetTerminalSettingsAsync(string merchantId, System.Threading.CancellationToken cancellationToken = default)
        {
            UriBuilder uriBuilder = new UriBuilder();

            try
            {
                ValidateGetTerminalSettings(merchantId);

                FormatGetTerminalSettings(ref merchantId);

                using (HttpRequestMessage httpRequestMessage = new HttpRequestMessage())
                {
                    uriBuilder.Host = HttpClient.BaseAddress!.Host;
                    uriBuilder.Port = HttpClient.BaseAddress.Port;
                    uriBuilder.Scheme = HttpClient.BaseAddress.Scheme;
                    uriBuilder.Path = HttpClient.BaseAddress.AbsolutePath == "/"
                        ? "/merchants/{merchantId}/terminalSettings"
                        : string.Concat(HttpClient.BaseAddress.AbsolutePath, "/merchants/{merchantId}/terminalSettings");
                    uriBuilder.Path = uriBuilder.Path.Replace("%7BmerchantId%7D", Uri.EscapeDataString(merchantId.ToString()));

                    ApiKeyToken apiKeyToken2 = (ApiKeyToken) ApiKeyProvider.Get();
                    apiKeyToken2.AddTokenToHttpRequestMessageHeader(httpRequestMessage);
                    httpRequestMessage.RequestUri = uriBuilder.Uri;

                    string[] accepts = new string[] {
                        "application/json"
                    };

                    string? accept = ClientUtils.SelectHeaderAccept(accepts);

                    if (accept != null)
                        httpRequestMessage.Headers.Accept.Add(new MediaTypeWithQualityHeaderValue(accept));

                    httpRequestMessage.Method = HttpMethod.Get;

                    DateTime requestedAt = DateTime.UtcNow;

                    using (HttpResponseMessage httpResponseMessage = await HttpClient.SendAsync(httpRequestMessage, cancellationToken).ConfigureAwait(false))
                    {
                        ILogger<TerminalSettingsCompanyLevelService.GetTerminalSettingsApiResponse> apiResponseLogger = LoggerFactory.CreateLogger<TerminalSettingsCompanyLevelService.GetTerminalSettingsApiResponse>();
                        TerminalSettingsCompanyLevelService.GetTerminalSettingsApiResponse apiResponse;

                        switch ((int)httpResponseMessage.StatusCode) {
                            default: {
                                string responseContent = await httpResponseMessage.Content.ReadAsStringAsync(cancellationToken).ConfigureAwait(false);
                                apiResponse = new(apiResponseLogger, httpRequestMessage, httpResponseMessage, responseContent, "/merchants/{merchantId}/terminalSettings", requestedAt, _jsonSerializerOptions);

                                break;
                            }
                        }

                        AfterGetTerminalSettingsDefaultImplementation(apiResponse, merchantId);

                        Events.ExecuteOnGetTerminalSettings(apiResponse);
                    
                        return apiResponse;
                    }
                }
            }
            catch(Exception e)
            {
                OnErrorGetTerminalSettingsDefaultImplementation(e, "/merchants/{merchantId}/terminalSettings", uriBuilder.Path, merchantId);
                Events.ExecuteOnErrorGetTerminalSettings(e);
                throw;
            }
        }

        partial void FormatUpdateTerminalLogo(ref string merchantId, ref string model, Option<Logo> logo);

        /// <summary>
        /// Validates the request parameters.
        /// </summary>
        /// <param name="merchantId"></param>
        /// <param name="model"></param>
        /// <param name="logo"></param>
        /// <returns></returns>
        private void ValidateUpdateTerminalLogo(string merchantId, string model, Option<Logo> logo)
        {
            if (merchantId == null)
                throw new ArgumentNullException(nameof(merchantId));

            if (model == null)
                throw new ArgumentNullException(nameof(model));

            if (logo.IsSet && logo.Value == null)
                throw new ArgumentNullException(nameof(logo));
        }

        /// <summary>
        /// Processes the server response.
        /// </summary>
        /// <param name="apiResponse"></param>
        /// <param name="merchantId"></param>
        /// <param name="model"></param>
        /// <param name="logo"></param>
        private void AfterUpdateTerminalLogoDefaultImplementation(IUpdateTerminalLogoApiResponse apiResponse, string merchantId, string model, Option<Logo> logo)
        {
            bool suppressDefaultLog = false;
            AfterUpdateTerminalLogo(ref suppressDefaultLog, apiResponse, merchantId, model, logo);
            if (!suppressDefaultLog)
                Logger.LogInformation("{0,-9} | {1} | {3}", (apiResponse.DownloadedAt - apiResponse.RequestedAt).TotalSeconds, apiResponse.StatusCode, apiResponse.Path);
        }

        /// <summary>
        /// Processes the server response.
        /// </summary>
        /// <param name="suppressDefaultLog"></param>
        /// <param name="apiResponse"></param>
        /// <param name="merchantId"></param>
        /// <param name="model"></param>
        /// <param name="logo"></param>
        partial void AfterUpdateTerminalLogo(ref bool suppressDefaultLog, IUpdateTerminalLogoApiResponse apiResponse, string merchantId, string model, Option<Logo> logo);

        /// <summary>
        /// Logs exceptions that occur while retrieving the server response.
        /// </summary>
        /// <param name="exception"></param>
        /// <param name="pathFormat"></param>
        /// <param name="path"></param>
        /// <param name="merchantId"></param>
        /// <param name="model"></param>
        /// <param name="logo"></param>
        private void OnErrorUpdateTerminalLogoDefaultImplementation(Exception exception, string pathFormat, string path, string merchantId, string model, Option<Logo> logo)
        {
            bool suppressDefaultLog = false;
            OnErrorUpdateTerminalLogo(ref suppressDefaultLog, exception, pathFormat, path, merchantId, model, logo);
            if (!suppressDefaultLog)
                Logger.LogError(exception, "An error occurred while sending the request to the server.");
        }

        /// <summary>
        /// A partial method that gives developers a way to provide customized exception handling.
        /// </summary>
        /// <param name="suppressDefaultLog"></param>
        /// <param name="exception"></param>
        /// <param name="pathFormat"></param>
        /// <param name="path"></param>
        /// <param name="merchantId"></param>
        /// <param name="model"></param>
        /// <param name="logo"></param>
        partial void OnErrorUpdateTerminalLogo(ref bool suppressDefaultLog, Exception exception, string pathFormat, string path, string merchantId, string model, Option<Logo> logo);

        /// <summary>
        /// Update the terminal logo Updates the logo for a specific payment terminal model at the merchant account identified in the path. You can update the logo for only one terminal model at a time.  This logo applies to all terminals of the specified model under the merchant account, unless a different logo is configured at a lower level (store or individual terminal).  * To change the logo, specify the image file as a Base64-encoded string. * To restore the logo inherited from the company account, specify an empty logo value.  To make this request, your API credential must have the following [role](https://docs.adyen.com/development-resources/api-credentials#api-permissions): * Management API—Terminal settings read and write  In the live environment, requests to this endpoint are subject to [rate limits](https://docs.adyen.com/point-of-sale/automating-terminal-management#rate-limits-in-the-live-environment).
        /// </summary>
        /// <exception cref="ApiException">Thrown when fails to make API call.</exception>
        /// <param name="merchantId">The unique identifier of the merchant account.</param>
        /// <param name="model">The terminal model. Allowed values: E355, VX675WIFIBT, VX680, VX690, VX700, VX820, M400, MX925, P400Plus, UX300, UX410, V200cPlus, V240mPlus, V400cPlus, V400m, e280, e285, e285p, S1E, S1EL, S1F2, S1L, S1U, S7T.</param>
        /// <param name="logo"> (optional)</param>
        /// <param name="cancellationToken">Cancellation Token to cancel the request.</param>
        /// <returns><see cref="Task"/>&lt;<see cref="IUpdateTerminalLogoApiResponse"/>&gt;</returns>
        public async Task<IUpdateTerminalLogoApiResponse> UpdateTerminalLogoAsync(string merchantId, string model, Option<Logo> logo = default, System.Threading.CancellationToken cancellationToken = default)
        {
            UriBuilder uriBuilder = new UriBuilder();

            try
            {
                ValidateUpdateTerminalLogo(merchantId, model, logo);

                FormatUpdateTerminalLogo(ref merchantId, ref model, logo);

                using (HttpRequestMessage httpRequestMessage = new HttpRequestMessage())
                {
                    uriBuilder.Host = HttpClient.BaseAddress!.Host;
                    uriBuilder.Port = HttpClient.BaseAddress.Port;
                    uriBuilder.Scheme = HttpClient.BaseAddress.Scheme;
                    uriBuilder.Path = HttpClient.BaseAddress.AbsolutePath == "/"
                        ? "/merchants/{merchantId}/terminalLogos"
                        : string.Concat(HttpClient.BaseAddress.AbsolutePath, "/merchants/{merchantId}/terminalLogos");
                    uriBuilder.Path = uriBuilder.Path.Replace("%7BmerchantId%7D", Uri.EscapeDataString(merchantId.ToString()));

                    System.Collections.Specialized.NameValueCollection parseQueryString = System.Web.HttpUtility.ParseQueryString(string.Empty);

                    parseQueryString["model"] = ClientUtils.ParameterToString(model);

                    uriBuilder.Query = parseQueryString.ToString();

                    if (logo.IsSet)
                        httpRequestMessage.Content = (logo.Value as object) is System.IO.Stream stream
                            ? httpRequestMessage.Content = new StreamContent(stream)
                            : httpRequestMessage.Content = new StringContent(JsonSerializer.Serialize(logo.Value, _jsonSerializerOptions));

                    ApiKeyToken apiKeyToken2 = (ApiKeyToken) ApiKeyProvider.Get();
                    apiKeyToken2.AddTokenToHttpRequestMessageHeader(httpRequestMessage);
                    httpRequestMessage.RequestUri = uriBuilder.Uri;

                    string[] contentTypes = new string[] {
                        "application/json"
                    };

                    string? contentType = ClientUtils.SelectHeaderContentType(contentTypes);

                    if (contentType != null && httpRequestMessage.Content != null)
                        httpRequestMessage.Content.Headers.ContentType = new MediaTypeHeaderValue(contentType);

                    string[] accepts = new string[] {
                        "application/json"
                    };

                    string? accept = ClientUtils.SelectHeaderAccept(accepts);

                    if (accept != null)
                        httpRequestMessage.Headers.Accept.Add(new MediaTypeWithQualityHeaderValue(accept));

                    httpRequestMessage.Method = HttpMethod.Patch;

                    DateTime requestedAt = DateTime.UtcNow;

                    using (HttpResponseMessage httpResponseMessage = await HttpClient.SendAsync(httpRequestMessage, cancellationToken).ConfigureAwait(false))
                    {
                        ILogger<TerminalSettingsCompanyLevelService.UpdateTerminalLogoApiResponse> apiResponseLogger = LoggerFactory.CreateLogger<TerminalSettingsCompanyLevelService.UpdateTerminalLogoApiResponse>();
                        TerminalSettingsCompanyLevelService.UpdateTerminalLogoApiResponse apiResponse;

                        switch ((int)httpResponseMessage.StatusCode) {
                            default: {
                                string responseContent = await httpResponseMessage.Content.ReadAsStringAsync(cancellationToken).ConfigureAwait(false);
                                apiResponse = new(apiResponseLogger, httpRequestMessage, httpResponseMessage, responseContent, "/merchants/{merchantId}/terminalLogos", requestedAt, _jsonSerializerOptions);

                                break;
                            }
                        }

                        AfterUpdateTerminalLogoDefaultImplementation(apiResponse, merchantId, model, logo);

                        Events.ExecuteOnUpdateTerminalLogo(apiResponse);
                    
                        return apiResponse;
                    }
                }
            }
            catch(Exception e)
            {
                OnErrorUpdateTerminalLogoDefaultImplementation(e, "/merchants/{merchantId}/terminalLogos", uriBuilder.Path, merchantId, model, logo);
                Events.ExecuteOnErrorUpdateTerminalLogo(e);
                throw;
            }
        }

        partial void FormatUpdateTerminalSettings(ref string merchantId, Option<TerminalSettings> terminalSettings);

        /// <summary>
        /// Validates the request parameters.
        /// </summary>
        /// <param name="merchantId"></param>
        /// <param name="terminalSettings"></param>
        /// <returns></returns>
        private void ValidateUpdateTerminalSettings(string merchantId, Option<TerminalSettings> terminalSettings)
        {
            if (merchantId == null)
                throw new ArgumentNullException(nameof(merchantId));

            if (terminalSettings.IsSet && terminalSettings.Value == null)
                throw new ArgumentNullException(nameof(terminalSettings));
        }

        /// <summary>
        /// Processes the server response.
        /// </summary>
        /// <param name="apiResponse"></param>
        /// <param name="merchantId"></param>
        /// <param name="terminalSettings"></param>
        private void AfterUpdateTerminalSettingsDefaultImplementation(IUpdateTerminalSettingsApiResponse apiResponse, string merchantId, Option<TerminalSettings> terminalSettings)
        {
            bool suppressDefaultLog = false;
            AfterUpdateTerminalSettings(ref suppressDefaultLog, apiResponse, merchantId, terminalSettings);
            if (!suppressDefaultLog)
                Logger.LogInformation("{0,-9} | {1} | {3}", (apiResponse.DownloadedAt - apiResponse.RequestedAt).TotalSeconds, apiResponse.StatusCode, apiResponse.Path);
        }

        /// <summary>
        /// Processes the server response.
        /// </summary>
        /// <param name="suppressDefaultLog"></param>
        /// <param name="apiResponse"></param>
        /// <param name="merchantId"></param>
        /// <param name="terminalSettings"></param>
        partial void AfterUpdateTerminalSettings(ref bool suppressDefaultLog, IUpdateTerminalSettingsApiResponse apiResponse, string merchantId, Option<TerminalSettings> terminalSettings);

        /// <summary>
        /// Logs exceptions that occur while retrieving the server response.
        /// </summary>
        /// <param name="exception"></param>
        /// <param name="pathFormat"></param>
        /// <param name="path"></param>
        /// <param name="merchantId"></param>
        /// <param name="terminalSettings"></param>
        private void OnErrorUpdateTerminalSettingsDefaultImplementation(Exception exception, string pathFormat, string path, string merchantId, Option<TerminalSettings> terminalSettings)
        {
            bool suppressDefaultLog = false;
            OnErrorUpdateTerminalSettings(ref suppressDefaultLog, exception, pathFormat, path, merchantId, terminalSettings);
            if (!suppressDefaultLog)
                Logger.LogError(exception, "An error occurred while sending the request to the server.");
        }

        /// <summary>
        /// A partial method that gives developers a way to provide customized exception handling.
        /// </summary>
        /// <param name="suppressDefaultLog"></param>
        /// <param name="exception"></param>
        /// <param name="pathFormat"></param>
        /// <param name="path"></param>
        /// <param name="merchantId"></param>
        /// <param name="terminalSettings"></param>
        partial void OnErrorUpdateTerminalSettings(ref bool suppressDefaultLog, Exception exception, string pathFormat, string path, string merchantId, Option<TerminalSettings> terminalSettings);

        /// <summary>
        /// Update terminal settings Updates payment terminal settings for the merchant account identified in the path. These settings apply to all terminals under the merchant account, unless different values are configured at a lower level (store or individual terminal).  * To change a parameter value, include the full object that contains the parameter, even if you don&#39;t want to change all parameters in the object. * To restore a parameter value inherited from a higher level, include the full object that contains the parameter, and specify an empty value for the parameter or omit the parameter. * Objects that are not included in the request are not updated.  To make this request, your API credential must have the following [role](https://docs.adyen.com/development-resources/api-credentials#api-permissions): * Management API—Terminal settings read and write    For [sensitive terminal settings](https://docs.adyen.com/point-of-sale/automating-terminal-management/configure-terminals-api#sensitive-terminal-settings), your API credential must have the following role: * Management API—Terminal settings Advanced read and write  In the live environment, requests to this endpoint are subject to [rate limits](https://docs.adyen.com/point-of-sale/automating-terminal-management#rate-limits-in-the-live-environment).
        /// </summary>
        /// <exception cref="ApiException">Thrown when fails to make API call.</exception>
        /// <param name="merchantId">The unique identifier of the merchant account.</param>
        /// <param name="terminalSettings"> (optional)</param>
        /// <param name="cancellationToken">Cancellation Token to cancel the request.</param>
        /// <returns><see cref="Task"/>&lt;<see cref="IUpdateTerminalSettingsApiResponse"/>&gt;</returns>
        public async Task<IUpdateTerminalSettingsApiResponse> UpdateTerminalSettingsAsync(string merchantId, Option<TerminalSettings> terminalSettings = default, System.Threading.CancellationToken cancellationToken = default)
        {
            UriBuilder uriBuilder = new UriBuilder();

            try
            {
                ValidateUpdateTerminalSettings(merchantId, terminalSettings);

                FormatUpdateTerminalSettings(ref merchantId, terminalSettings);

                using (HttpRequestMessage httpRequestMessage = new HttpRequestMessage())
                {
                    uriBuilder.Host = HttpClient.BaseAddress!.Host;
                    uriBuilder.Port = HttpClient.BaseAddress.Port;
                    uriBuilder.Scheme = HttpClient.BaseAddress.Scheme;
                    uriBuilder.Path = HttpClient.BaseAddress.AbsolutePath == "/"
                        ? "/merchants/{merchantId}/terminalSettings"
                        : string.Concat(HttpClient.BaseAddress.AbsolutePath, "/merchants/{merchantId}/terminalSettings");
                    uriBuilder.Path = uriBuilder.Path.Replace("%7BmerchantId%7D", Uri.EscapeDataString(merchantId.ToString()));

                    if (terminalSettings.IsSet)
                        httpRequestMessage.Content = (terminalSettings.Value as object) is System.IO.Stream stream
                            ? httpRequestMessage.Content = new StreamContent(stream)
                            : httpRequestMessage.Content = new StringContent(JsonSerializer.Serialize(terminalSettings.Value, _jsonSerializerOptions));

                    ApiKeyToken apiKeyToken2 = (ApiKeyToken) ApiKeyProvider.Get();
                    apiKeyToken2.AddTokenToHttpRequestMessageHeader(httpRequestMessage);
                    httpRequestMessage.RequestUri = uriBuilder.Uri;

                    string[] contentTypes = new string[] {
                        "application/json"
                    };

                    string? contentType = ClientUtils.SelectHeaderContentType(contentTypes);

                    if (contentType != null && httpRequestMessage.Content != null)
                        httpRequestMessage.Content.Headers.ContentType = new MediaTypeHeaderValue(contentType);

                    string[] accepts = new string[] {
                        "application/json"
                    };

                    string? accept = ClientUtils.SelectHeaderAccept(accepts);

                    if (accept != null)
                        httpRequestMessage.Headers.Accept.Add(new MediaTypeWithQualityHeaderValue(accept));

                    httpRequestMessage.Method = HttpMethod.Patch;

                    DateTime requestedAt = DateTime.UtcNow;

                    using (HttpResponseMessage httpResponseMessage = await HttpClient.SendAsync(httpRequestMessage, cancellationToken).ConfigureAwait(false))
                    {
                        ILogger<TerminalSettingsCompanyLevelService.UpdateTerminalSettingsApiResponse> apiResponseLogger = LoggerFactory.CreateLogger<TerminalSettingsCompanyLevelService.UpdateTerminalSettingsApiResponse>();
                        TerminalSettingsCompanyLevelService.UpdateTerminalSettingsApiResponse apiResponse;

                        switch ((int)httpResponseMessage.StatusCode) {
                            default: {
                                string responseContent = await httpResponseMessage.Content.ReadAsStringAsync(cancellationToken).ConfigureAwait(false);
                                apiResponse = new(apiResponseLogger, httpRequestMessage, httpResponseMessage, responseContent, "/merchants/{merchantId}/terminalSettings", requestedAt, _jsonSerializerOptions);

                                break;
                            }
                        }

                        AfterUpdateTerminalSettingsDefaultImplementation(apiResponse, merchantId, terminalSettings);

                        Events.ExecuteOnUpdateTerminalSettings(apiResponse);
                    
                        return apiResponse;
                    }
                }
            }
            catch(Exception e)
            {
                OnErrorUpdateTerminalSettingsDefaultImplementation(e, "/merchants/{merchantId}/terminalSettings", uriBuilder.Path, merchantId, terminalSettings);
                Events.ExecuteOnErrorUpdateTerminalSettings(e);
                throw;
            }
        }
    }
}
