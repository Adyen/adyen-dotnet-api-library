/*
 * POS Mobile API
 *
 * The POS Mobile API is used in the mutual authentication flow between an Adyen Android or iOS [POS Mobile SDK](https://docs.adyen.com/point-of-sale/ipp-mobile/) and the Adyen payments platform. The POS Mobile SDK for Android or iOS devices enables businesses to accept in-person payments using a commercial off-the-shelf (COTS) device like a phone. For example, Tap to Pay transactions, or transactions on a mobile device in combination with a card reader.  ## Authentication Each request to the POS Mobile API must be signed with an API key. [Generate your API key](https://docs.adyen.com/development-resources/api-credentials#generate-api-key) in the Customer Area and then set this key to the `X-API-Key` header value. You also need to have a [client key](https://docs.adyen.com/development-resources/client-side-authentication/). The client key is part of the setup but you won't need to use it in your integration later. Therefore, you don't need to specify allowed origins, and you don't need to store the key in your system.  To access the live endpoints, you need to generate a new API key and client key in your live Customer Area. ## Versioning  The POS Mobile API handles versioning as part of the endpoint URL.  For example: ``` https://checkout-test.adyen.com/checkout/possdk/v68/sessions ```  ## Going live  To access the live endpoints, you need an API key and client key from your live Customer Area.  The live endpoint URLs contain a prefix which is unique to your company account, for example: ``` https://{PREFIX}-checkout-live.adyenpayments.com/checkout/possdk/v68/sessions ```      
 *
 * The version of the OpenAPI document: 68
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

#nullable enable

using System;
using System.Linq;
using Microsoft.Extensions.DependencyInjection;
using Adyen.Core.Auth;
using Adyen.Core.Client;
using Adyen.PosMobile.Client;
using Adyen.PosMobile.Services;


namespace Adyen.PosMobile.Extensions
{
    /// <summary>
    /// Extension methods for <see cref="IServiceCollection"/>.
    /// </summary>
    public static class ServiceCollectionExtensions
    {

        /// <summary>
        /// Add all PosMobile services using the extension methods in <see cref="ServiceCollectionExtensions"/> and configures the <see cref="System.Net.Http.HttpClient"/> and <see cref="IHttpClientBuilder"/>.
        /// See: <see cref="PosMobileService"/>, 
        /// </summary>
        /// <param name="services"><see cref="IServiceCollection"/>.</param>
        /// <param name="serviceLifetime"><see cref="ServiceLifetime"/>.</param>
        /// <param name="httpClientOptions">Configures the <see cref="System.Net.Http.HttpClient"/>.</param>
        /// <param name="httpClientBuilderOptions">Configures the <see cref="IHttpClientBuilder"/>.</param>
        /// <returns><see cref="IServiceCollection"/>.</returns>
        public static IServiceCollection AddAllPosMobileServices(this IServiceCollection services, ServiceLifetime serviceLifetime = ServiceLifetime.Singleton, Action<System.Net.Http.HttpClient>? httpClientOptions = null, Action<IHttpClientBuilder>? httpClientBuilderOptions = null)
        {            
            services.AddPosMobileService(serviceLifetime, httpClientOptions, httpClientBuilderOptions);
            
            return services;
        }



        /// <summary>
        /// Add <see cref="PosMobileService"/> as the implementation of <see cref="IPosMobileService"/> to the Dependency Injection container <see cref="IServiceCollection"/>. 
        /// </summary>
        /// <param name="services"><see cref="IServiceCollection"/>.</param>
        /// <param name="serviceLifetime">Configures the <see cref="ServiceLifetime"/>, defaults to <see cref="ServiceLifetime.Singleton"/>.</param>
        /// <returns><see cref="IServiceCollection"/>.</returns>
        public static IServiceCollection AddPosMobileService(this IServiceCollection services, ServiceLifetime serviceLifetime = ServiceLifetime.Singleton, Action<System.Net.Http.HttpClient>? httpClientOptions = null, Action<IHttpClientBuilder>? httpClientBuilderOptions = null)
        {
            services.AddSingleton<IApiFactory, ApiFactory>();
            services.AddSingleton<PosMobileServiceEvents>();

            services.Add(new ServiceDescriptor(typeof(IPosMobileService), typeof(PosMobileService), serviceLifetime));

            IHttpClientBuilder builder = services.AddHttpClient<IPosMobileService, PosMobileService>(httpClient =>
            {
                httpClientOptions?.Invoke(httpClient);
            });

            httpClientBuilderOptions?.Invoke(builder);
            return services;
        }

    }
}
